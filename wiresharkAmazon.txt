/* ============================================================
   CN Practical – SSL / TLS Protocol Study using Wireshark
   (Example: Amazon.com – Secure HTTPS Communication)
   ============================================================

   AIM:
   ----
   To study the working of the SSL/TLS protocol by capturing packets 
   in Wireshark while accessing an SSL-secured website such as 
   Amazon.com, and to analyze the handshake process for secure communication.

   ============================================================
   THEORY:
   ============================================================

   - SSL (Secure Socket Layer) and its successor TLS (Transport Layer Security)
     are cryptographic protocols that provide security over the Internet.
   - They ensure:
       • Confidentiality  → Encrypting transmitted data
       • Integrity         → Preventing data tampering
       • Authentication    → Verifying the identity of communicating parties
   - SSL/TLS is most commonly used in HTTPS connections 
     (port 443), such as e-commerce, banking, and login sites.

   ============================================================
   SOFTWARE REQUIRED:
   ============================================================
   - Wireshark (latest version)
   - Web browser (Chrome / Edge / Firefox)
   - Internet connectivity

   ============================================================
   SETUP INSTRUCTIONS (WINDOWS / UBUNTU)
   ============================================================

   Step 1: Install Wireshark
           - Download from: https://www.wireshark.org/
           - Install with default options.

   Step 2: Open Wireshark.
           - Select your active network interface (Wi-Fi or Ethernet).

   Step 3: Start capturing packets 
           - Click on the Blue Shark icon ("Start Capturing").

   Step 4: Open your web browser and visit:
           https://www.amazon.com

   Step 5: Log in with valid credentials (optional; for SSL session creation).

   Step 6: After a few seconds, return to Wireshark and click the Red Square 
           (“Stop Capturing Packets”).

   ============================================================
   PROCEDURE TO ANALYZE SSL / TLS PACKETS
   ============================================================

   1. Open Wireshark and begin packet capture.
   2. Open Amazon.com and perform login or browsing actions.
   3. Stop capture after SSL/TLS packets appear in Wireshark.
   4. Apply the following filters to view relevant packets:

      a) To view all SSL/TLS packets:
         tls  OR  ssl

      b) To view a specific TCP stream:
         tcp.stream eq <number>   (Example: tcp.stream eq 20)

      c) Combine both filters:
         tcp.stream eq 20 && ssl

   5. Locate the following key packets in Wireshark:
      - “Client Hello”
      - “Server Hello”
      - “Certificate”
      - “Server Key Exchange”
      - “Client Key Exchange”
      - “Change Cipher Spec”
      - “Encrypted Handshake Message”

   6. Right-click on any “Client Hello” packet → Follow → TLS Stream.
      - A new popup will open → Close it.
      - Wireshark automatically generates a display filter (example: tcp.stream eq 20).

   7. Apply this filter and inspect packets under the “Transport Layer Security” section.
      - Expand the arrow (▶) beside “TLS Record Layer”.
      - Observe the handshake messages in detail.

   8. Similarly, right-click on the “Server Hello” packet → Follow → TLS Stream.
      - This will isolate packets in the server’s handshake stream.

   ============================================================
   PACKET FLOW EXPLANATION
   ============================================================

   SSL / TLS HANDSHAKE STEPS:

   1. **Client Hello**  
      - The browser (client) sends supported TLS versions, ciphers, and random data.

   2. **Server Hello**  
      - The server responds with chosen cipher suite and its digital certificate.

   3. **Certificate**  
      - The server sends an SSL certificate containing its public key.

   4. **Server Key Exchange (optional)**  
      - Used in Diffie-Hellman key exchanges to share session parameters.

   5. **Client Key Exchange**  
      - The client generates a session key and encrypts it with the server’s public key.

   6. **Change Cipher Spec**  
      - The client and server switch to encrypted communication.

   7. **Encrypted Handshake Message**  
      - Both sides confirm the handshake is complete and secure communication begins.

   ============================================================
   FILTER COMMANDS SUMMARY
   ============================================================

   tls                                      → Show all TLS packets
   ssl                                      → Show all SSL packets (legacy term)
   tcp.port == 443                          → Show HTTPS traffic
   tcp.stream eq 20                         → Focus on a specific TCP connection
   tcp.stream eq 20 && ssl                  → Combine both to analyze specific SSL stream

   ============================================================
   HOW TO VERIFY SSL SESSION ESTABLISHMENT
   ============================================================

   1. Observe “Client Hello” and “Server Hello” packets.
   2. Expand “Transport Layer Security” details:
      - Check “Version: TLS 1.2” or “TLS 1.3”
      - Check “Cipher Suite” used (e.g., TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)
   3. Verify “Certificate” field for:
      - Issuer: (e.g., Amazon Root CA)
      - Subject: (e.g., www.amazon.com)
   4. Locate “Change Cipher Spec” packet → indicates encryption activation.
   5. All subsequent packets will appear as “Encrypted Application Data”.

   ============================================================
   PACKET FLOW ANALYSIS
   ============================================================

   CLIENT  →  SERVER
   --------------------------------------------
   1. Client Hello
   2. Server Hello
   3. Server Certificate
   4. Server Key Exchange
   5. Client Key Exchange
   6. Change Cipher Spec
   7. Encrypted Handshake Message
   --------------------------------------------
   SECURE CONNECTION ESTABLISHED

   - After step 7, data is encrypted using session keys.
   - All packets appear as “Application Data” in Wireshark.

   ============================================================
   OBSERVATIONS
   ============================================================

   - Port 443 (HTTPS) is used for SSL communication.
   - Encryption algorithms (cipher suites) are negotiated dynamically.
   - The Certificate chain verifies the server identity.
   - Once encryption starts, packet content becomes unreadable.

   ============================================================
   SECURITY CONCEPTS STUDIED
   ============================================================

   - **Encryption:** Converts plain text into cipher text.
   - **Decryption:** Converts cipher text back to plain text.
   - **Public/Private Keys:** Used in asymmetric cryptography.
   - **Digital Certificate:** Confirms authenticity of a server.
   - **TLS Version:** Determines protocol strength (e.g., TLS 1.2 or TLS 1.3).

   ============================================================
   30 ORAL / VIVA QUESTIONS AND ANSWERS
   ============================================================

   1. Q: What is SSL?
      A: Secure Socket Layer – a security protocol for encrypted communication.

   2. Q: What is TLS?
      A: Transport Layer Security – improved version of SSL.

   3. Q: Which port does HTTPS use?
      A: Port 443.

   4. Q: What does SSL/TLS ensure?
      A: Confidentiality, Integrity, and Authentication.

   5. Q: What is the difference between SSL and TLS?
      A: TLS is the modern, more secure version of SSL.

   6. Q: What command filters all SSL packets in Wireshark?
      A: ssl or tls

   7. Q: What is the “Client Hello” message?
      A: It initiates the handshake by proposing protocol version and cipher suites.

   8. Q: What is the “Server Hello” message?
      A: The server’s response confirming protocol and cipher suite.

   9. Q: What is a cipher suite?
      A: A set of algorithms for encryption, hashing, and key exchange.

   10. Q: What is a digital certificate?
       A: A file issued by a trusted authority confirming a website’s identity.

   11. Q: What does the certificate contain?
       A: Public key, issuer, validity dates, and owner details.

   12. Q: What does “Change Cipher Spec” mean?
       A: The point where encryption begins.

   13. Q: What filter isolates the Amazon SSL session?
       A: tcp.stream eq 20 && ssl

   14. Q: What does “Follow TLS Stream” do?
       A: Displays the complete communication for a specific SSL session.

   15. Q: What is asymmetric encryption?
       A: Uses public and private key pairs for secure data exchange.

   16. Q: What protocol layer does SSL/TLS operate at?
       A: Transport Layer (Layer 4).

   17. Q: What port number indicates HTTPS?
       A: Port 443.

   18. Q: Can you read SSL packet data in Wireshark?
       A: No, it’s encrypted unless you have session keys.

   19. Q: What version of TLS is most secure currently?
       A: TLS 1.3.

   20. Q: What is PKI?
       A: Public Key Infrastructure, used for managing keys and certificates.

   21. Q: What does HTTPS stand for?
       A: HyperText Transfer Protocol Secure.

   22. Q: What is the main difference between HTTP and HTTPS?
       A: HTTPS uses SSL/TLS encryption.

   23. Q: What happens if the certificate is invalid?
       A: Browser shows a “Not Secure” or “Certificate Error” warning.

   24. Q: What does the padlock icon in browser indicate?
       A: An SSL-secured website.

   25. Q: What is the function of “Server Certificate” in handshake?
       A: It authenticates the server’s identity.

   26. Q: What type of encryption is used for SSL/TLS session keys?
       A: Symmetric encryption (after handshake).

   27. Q: Which algorithm is used for key exchange in TLS?
       A: Diffie-Hellman or RSA.

   28. Q: What does the term “Application Data” mean in Wireshark after handshake?
       A: Encrypted traffic between client and server.

   29. Q: Why is SSL important for e-commerce sites like Amazon?
       A: To secure user credentials, payments, and transactions.

   30. Q: How do you verify SSL details in browser?
       A: Click the padlock → View Certificate → Check issuer and validity.

   ============================================================
   CONCLUSION
   ============================================================

   - SSL/TLS packets were successfully captured using Wireshark.
   - The handshake process (Client Hello → Server Hello → Certificate → Encrypted Data)
     was observed for Amazon.com.
   - Encryption and authentication details were analyzed through TLS records.
   - This practical demonstrated how SSL/TLS ensures secure communication 
     over HTTPS in real-world web transactions.

   ============================================================
   END OF FILE
   ============================================================
*/
